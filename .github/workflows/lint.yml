name: Lint & Code Quality

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  lint:
    name: Run Linters
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'
          cache: 'pip'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install ruff black isort mypy
          # Install project dependencies for type checking
          pip install -r requirements.txt || true

      - name: Run Ruff (Linter)
        run: |
          echo "üîç Running Ruff linter..."
          ruff check src/ tests/ --output-format=github
        continue-on-error: false

      - name: Run Black (Formatter Check)
        run: |
          echo "üé® Checking code formatting with Black..."
          black src/ tests/ --check --line-length 100 --target-version py312
        continue-on-error: false

      - name: Run isort (Import Check)
        run: |
          echo "üì¶ Checking import sorting with isort..."
          isort src/ tests/ --check-only --profile black
        continue-on-error: false

      - name: Run MyPy (Type Checking)
        run: |
          echo "üîé Running type checks with MyPy..."
          mypy src/ --ignore-missing-imports || echo "‚ö†Ô∏è  Type checking warnings (not blocking)"
        continue-on-error: true  # Don't fail on type errors (warning only)

      - name: Summary
        if: success()
        run: |
          echo "‚úÖ All linting checks passed!"
